INSERT INTO TESTDB.FNL_PRM

select A.FromPaperID, A.ToPaperId, B.IN_DEGREE, C.OUT_DEGREE, D.AUTH_OVERLAP, 
E.CNT, F.MEAN, G.MAX_CNT, H.MEAN, I.MEAN, J.MEAN_CITE, K.MEAN_REF, L.MEAN_REf

FROM (
	SELECT A1.PAPER_ID AS FromPaperID, A2.PAPER_ID AS ToPaperId
	FROM TESTDB.PAPER AS A1, TESTDB.PAPER AS A2
	WHERE PAPER_ID BETWEEN 301001 AND 304271
)as A
INNER JOIN TESTDB.IN_DEGREE AS B
ON A.ToPaperId=B.PAPER_ID
INNER JOIN TESTDB.OUT_DEGREE AS C
ON A.ToPaperId=B.PAPER_ID
INNER JOIN TESTDB.AUTH_OVERLAP AS D
ON A.FromPaperID=D.FromPaperID
AND A.ToPaperId=D.ToPaperID
INNER JOIN TESTDB.MaxACollWithB AS E
ON A.FromPaperID=E.FromPaperID
AND A.ToPaperId=E.ToPaperID
INNER JOIN TESTDB.MeanACollWithB AS F
ON A.FromPaperID=F.FromPaperID
AND A.ToPaperId=F.ToPaperID
INNER JOIN TESTDB.MaxOfACiteB AS G
ON A.FromPaperID=G.FromPaperID
AND A.ToPaperId=G.ToPaperID
INNER JOIN TESTDB.MeanOfACiteB AS H
ON A.FromPaperID=H.FromPaperID
AND A.ToPaperId=H.ToPaperID
INNER JOIN TESTDB.AvgCiteA AS I
ON A.FromPaperID=I.FromPaperId
INNER JOIN TESTDB.AvgCiteB AS J
ON A.ToPaperId=J.ToPaperID
INNER JOIN TESTDB.AvgRefA AS K
ON A.FromPaperID=K.FromPaperID
INNER JOIN TESTDB.AvgRefB AS L
ON A.ToPaperId=L.ToPaperID


UPDATE TESTDB.FNL_PRM AS A 
INNER JOIN TESTDB.PaperCitation AS K 
ON A.FromPaperID=K.FromPaperID or A.FromPaperID=K.ToPaperId 
SET A.LINK = 1
